<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Calculadora</title>
    <meta name="theme-color" content="#007bff">
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f0f2f5; margin: 0; padding: 0; padding-bottom: 90px; }
        
        /* --- CABE√áALHO --- */
        .header-total {
            background: #fff; padding: 25px 20px; text-align: center;
            position: sticky; top: 0; z-index: 100;
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
            border-bottom-left-radius: 24px; border-bottom-right-radius: 24px;
        }
        .label-total { font-size: 0.85rem; color: #888; text-transform: uppercase; letter-spacing: 1px; font-weight: 600; }
        .valor-total { font-size: 3.2rem; font-weight: 800; color: #2e7d32; margin: 5px 0 15px 0; letter-spacing: -1px; transition: color 0.3s; }
        .valor-total.estourou { color: #d32f2f; }

        /* Meta e Barra */
        .meta-wrapper { display: flex; flex-direction: column; align-items: center; gap: 8px; }
        .progress-bg { width: 100%; max-width: 220px; height: 10px; background: #f1f3f5; border-radius: 10px; overflow: hidden; }
        .progress-fill { height: 100%; background: #2e7d32; width: 0%; transition: width 0.5s, background 0.3s; border-radius: 10px; }
        .btn-meta { background: #fff; border: 1px solid #e0e0e0; padding: 6px 14px; border-radius: 20px; font-size: 0.85rem; color: #666; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.02); }

        /* --- FORMUL√ÅRIO (Mobile Layout) --- */
        .add-area { 
            background: white; margin: 20px 15px; padding: 20px; 
            border-radius: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.03); 
            display: flex; flex-direction: column; gap: 12px; /* Empilha os campos */
        }
        
        input { 
            width: 100%; padding: 14px; border: 1px solid #eee; border-radius: 12px; 
            font-size: 1.1rem; outline: none; background: #f9f9f9; transition: 0.2s;
        }
        input:focus { border-color: #007bff; background: #fff; box-shadow: 0 0 0 3px rgba(0,123,255,0.1); }
        
        /* Linha com Pre√ßo e Qtd lado a lado */
        .row-inputs { display: flex; gap: 10px; }
        .input-group { flex: 1; } /* Cada um ocupa metade */
        
        .btn-add { 
            width: 100%; padding: 16px; background: #007bff; color: white; border: none; 
            border-radius: 12px; font-weight: 700; font-size: 1.1rem; cursor: pointer; 
            box-shadow: 0 4px 12px rgba(0,123,255,0.25); margin-top: 5px;
        }
        .btn-add:active { transform: scale(0.98); background: #0069d9; }

        /* --- LISTA DE ITENS --- */
        .item-list { list-style: none; padding: 0; margin: 0 15px; }
        .item-row { 
            background: white; padding: 16px; margin-bottom: 12px; border-radius: 16px; 
            display: flex; justify-content: space-between; align-items: center; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.03); 
        }
        .item-name { font-weight: 700; font-size: 1.05rem; color: #333; display: block; margin-bottom: 4px; }
        .item-calc { font-size: 0.9rem; color: #888; }
        .item-price-total { font-weight: 800; font-size: 1.1rem; color: #2e7d32; }
        
        .btn-remove { 
            background: #fff5f5; color: #e53935; border: none; width: 40px; height: 40px; 
            border-radius: 12px; margin-left: 12px; cursor: pointer; font-size: 1.4rem; 
            display: flex; align-items: center; justify-content: center;
        }

        /* Bot√£o Voltar */
        .fab-back { 
            position: fixed; bottom: 25px; left: 25px; 
            background: white; color: #333; width: 55px; height: 55px; border-radius: 50%; 
            display: flex; align-items: center; justify-content: center; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.15); text-decoration: none; font-size: 24px; z-index: 200; 
        }
    </style>
</head>
<body>

<div class="header-total">
    <div class="label-total">Total Previsto</div>
    <div class="valor-total" id="display-total">R$ 0,00</div>
    
    <div class="meta-wrapper">
        <div class="progress-bg"><div class="progress-fill" id="progress-bar"></div></div>
        <button class="btn-meta" onclick="definirMeta()">
            üéØ Meta: <span id="label-meta" style="margin-left:5px">Definir</span>
        </button>
    </div>
</div>

<div class="add-area">
    <input type="text" id="inp-nome" placeholder="Nome do produto (Opcional)">
    
    <div class="row-inputs">
        <div class="input-group" style="flex: 2;"> <input type="number" id="inp-preco" placeholder="R$ Pre√ßo" step="0.01" inputmode="decimal">
        </div>
        <div class="input-group" style="flex: 1;"> <input type="number" id="inp-qtd" value="1" style="text-align:center" inputmode="numeric">
        </div>
    </div>

    <button class="btn-add" onclick="adicionarItem()">Adicionar ao Carrinho</button>
</div>

<div id="lista-itens" class="item-list">
    <div style="text-align:center; padding: 40px; opacity: 0.6;">
        <div style="font-size: 3rem; margin-bottom:10px;">üõí</div>
        <div>Seu carrinho est√° vazio</div>
    </div>
</div>

<a href="index.html" class="fab-back">‚¨Ö</a>

<script>
    let itens = [];
    let meta = localStorage.getItem('metaCarrinho') || 0;

    if(localStorage.getItem('carrinhoTemp')) {
        itens = JSON.parse(localStorage.getItem('carrinhoTemp'));
        renderizar();
    }
    atualizarMetaDisplay();

    function adicionarItem() {
        const nomeInp = document.getElementById('inp-nome');
        const precoInp = document.getElementById('inp-preco');
        const qtdInp = document.getElementById('inp-qtd');

        const nome = nomeInp.value || 'Item ' + (itens.length + 1);
        const preco = parseFloat(precoInp.value);
        const qtd = parseFloat(qtdInp.value);

        if (!preco || isNaN(preco)) {
            alert("Digite o pre√ßo!");
            precoInp.focus();
            return;
        }

        const item = { id: Date.now(), nome, preco, qtd, total: preco * qtd };

        itens.unshift(item);
        salvar();
        renderizar();
        
        // Limpar inteligente: Foca no pre√ßo direto
        nomeInp.value =